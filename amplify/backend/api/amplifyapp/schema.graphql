# This "input" configures a global authorization rule to enable public access to
# all models in this schema. Learn more about authorization rules here: https://docs.amplify.aws/cli/graphql/authorization-rules
# input AMPLIFY { globalAuthRule: AuthRule = { allow: public } } # FOR TESTING ONLY!

type User 
  @model 
  @auth(
    rules: [
      # allow admins to create, update and delete user
      { allow: groups, groups: ["admin"] },
      # allow ownner to create, update and delete user
      { allow: owner },
      # allow all authenticated users to view other users' information
      { allow: private, operations: [read] },
      # allow non authenticated users to create an user
      { allow: public, operations: [create], provider: iam }
    ]
  ) {

  id: ID!
  email: String!
  emailVerified: Boolean!
  #photo: S3Object
  rol: String!
  #subscriptions: [String]
  #To prevent an owner from reassigning their record to another user https://docs.amplify.aws/cli/graphql/authorization-rules/#per-user--owner-based-data-access
  #owner: String @auth(rules: [{ allow: owner, operations: [read, delete] }])

}

type S3Object {
  bucket: String!
  region: String!
  key: String!
}

type Article @model @auth(rules: [{ allow: groups, groups: ["admin"] }, { allow: private, operations: [read] }]) {
  id: ID!
  name: String!
  topics: [String]!
  author: String!
  html: String #S3Object!
}
